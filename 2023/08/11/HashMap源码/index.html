<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="HashMapæºç è§£è¯»" />
    <meta name="hexo-theme-A4" content="v1.6.9" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Lau | Learning..</title>

    
        
            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/reset.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/markdown.css">

            
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/fonts.css">
 
            <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
            
        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <style>
        :root {
            --waline-theme-color: #fdbb30; 
            --waline-color: #fdbb30; 
            --waline-border-color: #fdbb30; 
            --waline-white: #fdbb30; 
            --waline-bgcolor-light: #247aac;  
        }
        body {
            color: #fdbb30;
            background: #c96149;
        }
        .post-md code {
            background: black;
            color: white; 
        }
        .year-font-color {
            color: #fdbb30 !important;
        }
        .wl-card span.wl-nick {
            color: #fdbb30; 
        }
        .wl-card .wl-badge {
            border: 1px solid #fdbb30;
            color: #fdbb30; 
        }
        .wl-btn {
            border: 1px solid #fdbb30; 
            color:  #fdbb30;  
        }
        .wl-btn.primary {
            color: #247aac; 
        }
        .wl-header label {
            color: #fdbb30;
        }
        a {
            color: #fec591;
        }

        .post-md a {
            color: #fec591;
        }

        .nav li a {
            color: #fec591;
        }

        .archive-main a:link {
            color: #fec591;
        }
        .archive-main a:visited {
            color: #002d62; 
        }

        .archive li span {
            color: #fdbb30;
        }

        .post-main-title {
            color: #fdbb30;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #fdbb30;
        }

        [data-waline] p {
            color: #fdbb30;
        }
        [data-waline] a {
            color: #fdbb30;
        } 
        .wl-sort li.active {
            color: #fdbb30;
        }

        .wl-card .wl-meta>span {
            background: #247aac;
        }

        .paper {
            background: #c96149;
        }

        .index-main {
            background: #fdfdfe;
        }

        .paper-main {
            background: #247aac;
        }

        .wl-panel {
            background: #247aac;
        }

        .archive li:nth-child(odd) {
            background: #247aac;
            ;
        }

        .archive li:nth-child(even) {
            background: #247aac;
        }

        .post-md>table tr:nth-child(odd) td {
            background: #247aac;
        }

        .post-md>table tr:nth-child(even) td {
            background: #247aac;
        }
    </style>

    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Lau</a> 
            <span class="description">Empty your mind. Be formless, shapeless, like water.</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
            
                <li><a href="/tags/">æ ‡ç­¾</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            HashMapæºç è§£è¯»
        </div>
      
    

    <div class="post-md">
        
            
        
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><hr>
<pre><code>public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;
    implements Map&lt;K,V&gt;, Cloneable, Serializable &#123;
//è‹¥åœ¨åˆ›å»ºHashMapæ—¶æŒ‡å®šå¤§å°ï¼Œå…ˆå°†åˆå§‹å®¹é‡å€¼ç»tableSizeFor()æ–¹æ³•å¤„ç†åå¤åˆ¶ç»™threshold
this.threshold = tableSizeFor(initialCapacity);

//è¿”å›ä¸€ä¸ªå¤§äºç­‰äºä¼ å…¥å‚æ•°çš„æœ€å°çš„äºŒçš„å¹‚æ¬¡æ–¹çš„å€¼ï¼Œ|=ï¼ˆæˆ–ç­‰äºï¼‰
static final int tableSizeFor(int cap) &#123;
        int n = cap - 1; //è‹¥ä¸-1,å½“capå·²æ˜¯äºŒçš„å¹‚æ¬¡æ–¹æ—¶ï¼Œè¿”å›çš„å€¼ä¼šç¿»å€ã€‚
        n |= n &gt;&gt;&gt; 1;	// n = n | n &gt;&gt;&gt; 1;
        n |= n &gt;&gt;&gt; 2;
        n |= n &gt;&gt;&gt; 4;
        n |= n &gt;&gt;&gt; 8;
        n |= n &gt;&gt;&gt; 16;
        return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
    &#125;

//è¿”å›è¢«æ›¿æ¢çš„å€¼ï¼Œè‹¥æ²¡æœ‰æ­¤é”®çš„æ˜ å°„åˆ™è¿”å›nullï¼Œnullä¹Ÿå¯ä»¥è¡¨ç¤ºè¢«æ›¿æ¢çš„valueå€¼ä¸ºnull
public V put(K key, V value) &#123;
        return putVal(hash(key), key, value, false, true);
    &#125;

/*å°†keyçš„hashcodeå€¼ä¸hashcodeå€¼æ— ç¬¦å·å³ç§»åå…­ä½åçš„å€¼ï¼ˆå³ä½åå…­ä½ä¸é«˜åå…­ä½ï¼‰è¿›è¡Œå¼‚æˆ–è¿ç®—åè¿”å›ï¼Œä½¿ç”¨å¼‚æˆ–è¿ç®—å¯ç­‰æ¦‚ç‡å¾—åˆ°0å’Œ1ï¼Œç»“æœéšæœºæ€§æ›´å¤§ï¼Œå“ˆå¸Œç¢°æ’æ¦‚ç‡éšä¹‹å‡å°*/
static final int hash(Object key) &#123;
        int h;
        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);
    &#125;

//å¾€HashMapä¸­æ’å…¥å€¼çš„å…·ä½“å®ç°
final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) &#123;
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;
        //Node&lt;K, V&gt; tab æœªåˆå§‹åŒ–æˆ–é•¿åº¦ä¸º0,è¿›è¡Œresize()æ‰©å®¹æ“ä½œ
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        /*i = (n - 1) &amp; hashï¼Œn-1åäºŒè¿›åˆ¶ä½ä½éƒ½æ˜¯1ï¼Œä¸hash()æ–¹æ³•è¿”å›çš„å€¼è¿›è¡Œä¸è¿ç®—ï¼Œç»“æœå€¼å¿…ç„¶åœ¨n-1åŒºé—´å†…ï¼Œå¯å®ç°å–æ¨¡è¿ç®—ï¼Œä¸”ä½è¿ç®—é€Ÿåº¦æ›´å¿«*/
        if ((p = tab[i = (n - 1) &amp; hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        else &#123;
            Node&lt;K,V&gt; e; K k;
            if (p.hash == hash &amp;&amp;
                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
                e = p;
            else if (p instanceof TreeNode)
                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);
            else &#123;
                for (int binCount = 0; ; ++binCount) &#123;
                    if ((e = p.next) == null) &#123;
                        p.next = newNode(hash, key, value, null);
                        /*é“¾è¡¨èŠ‚ç‚¹æ•°å¤§äº8æ—¶è½¬çº¢é»‘æ ‘ï¼ŒbinCountä»0å¼€å§‹ï¼Œåˆ°7æ—¶å·²æ˜¯ç¬¬å…«ä¸ªå…ƒç´ ï¼Œä¸”è§¦å‘ifå·²æ–°å¢èŠ‚ç‚¹ä¸”è¿˜æœ‰æ¬¡è‡ªå¢æ“ä½œæ²¡å®Œæˆå°±breakï¼Œå³é“¾è¡¨ä¸­å…ƒç´ è¾¾åˆ°ä¹ä¸ªæ—¶æ‰è§¦å‘treeifyBin()*/
                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    &#125;
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        break;
                    p = e;
                &#125;
            &#125;
            if (e != null) &#123; // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            &#125;
        &#125;
        ++modCount;
        if (++size &gt; threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    &#125;

//åˆå§‹åŒ–æˆ–å°†æ•°ç»„å¤§å°ç¿»å€
final Node&lt;K,V&gt;[] resize() &#123;
        Node&lt;K,V&gt;[] oldTab = table;
        int oldCap = (oldTab == null) ? 0 : oldTab.length;
        int oldThr = threshold;
        int newCap, newThr = 0;
        if (oldCap &gt; 0) &#123;
            if (oldCap &gt;= MAXIMUM_CAPACITY) &#123;
                threshold = Integer.MAX_VALUE;
                return oldTab;
            &#125;
            else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;
                     oldCap &gt;= DEFAULT_INITIAL_CAPACITY)
                newThr = oldThr &lt;&lt; 1; // double threshold
        &#125;
        else if (oldThr &gt; 0) // initial capacity was placed in threshold
            //å¦‚æœæŒ‡å®šäº†æ•°ç»„å¤§å°åˆ™å°†å­˜æ”¾åœ¨thresholdä¸­çš„å®¹é‡å¤§å°è®¾ç½®æ•°ç»„åˆå§‹åŒ–é•¿åº¦
            newCap = oldThr;
        else &#123;               // zero initial threshold signifies using defaults
            newCap = DEFAULT_INITIAL_CAPACITY;
            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
        &#125;
        if (newThr == 0) &#123;
            float ft = (float)newCap * loadFactor;
            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?
                      (int)ft : Integer.MAX_VALUE);
        &#125;
        threshold = newThr;
        @SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)
            //ç¬¬ä¸€æ¬¡è°ƒç”¨putæ–¹æ³•æ—¶ï¼Œæ‰é€æ­¥æ‰§è¡Œåˆ°è¿™æ¡è¯­å¥åˆ›å»ºæ•°ç»„ï¼Œå»¶è¿ŸåŠ è½½ï¼Œæé«˜æ•ˆç‡ã€‚
            Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];
        table = newTab;
        if (oldTab != null) &#123;
            for (int j = 0; j &lt; oldCap; ++j) &#123;
                Node&lt;K,V&gt; e;
                if ((e = oldTab[j]) != null) &#123;
                    oldTab[j] = null;
                    if (e.next == null)
                        newTab[e.hash &amp; (newCap - 1)] = e;
                    else if (e instanceof TreeNode)
                        //splitæ–¹æ³•ä¸ä¸‹é¢å¯¹é“¾è¡¨çš„å¤„ç†ç±»ä¼¼
                        ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);
                    else &#123; // preserve order
                        //ä¸‹æ ‡ä½ç½®ä¸éœ€ç§»åŠ¨çš„é“¾è¡¨
                        Node&lt;K,V&gt; loHead = null, loTail = null;
                        //ä¸‹æ ‡ä½ç½®éœ€è¦ç§»åŠ¨çš„é“¾è¡¨
                        Node&lt;K,V&gt; hiHead = null, hiTail = null;
                        Node&lt;K,V&gt; next;
                        do &#123;
                            next = e.next;
                            /*(e.hash &amp; oldCap) == 0ï¼Œåˆ¤æ–­å…ƒç´ æ‰€å¤„ä¸‹æ ‡ä½ç½®æ˜¯å¦éœ€è¦ç§»åŠ¨ã€‚æ—§æ•°ç»„è®¡ç®—ä¸‹æ ‡i = (n - 1) &amp; hashï¼Œæ–°æ•°ç»„ä¸ºå°±æ•°ç»„çš„ä¸¤å€ï¼Œåˆ™æ–°æ•°ç»„ä¸‹æ ‡è®¡ç®—ä¸ºi = (2n - 1) &amp; hashï¼Œä¸¤è€…å·®åˆ«åªåœ¨æ—§æ•°ç»„é•¿åº¦è½¬ä¸ºäºŒè¿›åˆ¶çš„é‚£ä½ä¸Šã€‚è‹¥e.hash &amp; oldCapçš„å€¼ä¸º0ï¼Œåˆ™è¯¥å…ƒç´ åœ¨æ–°æ•°ç»„å’Œæ—§æ•°ç»„çš„ä¸‹æ ‡ä¸€è‡´ã€‚*/
                            if ((e.hash &amp; oldCap) == 0) &#123;
                                if (loTail == null)
                                    loHead = e;
                                else
                                    loTail.next = e;
                                loTail = e;
                            &#125;
                            else &#123;
                                if (hiTail == null)
                                    hiHead = e;
                                else
                                    hiTail.next = e;
                                hiTail = e;
                            &#125;
                        &#125; while ((e = next) != null);
                        //åŸä½ç½®çš„é“¾è¡¨ï¼Œæ•°ç»„ä¸‹æ ‡ä¸å˜
                        if (loTail != null) &#123;
                            loTail.next = null;
                            newTab[j] = loHead;
                        &#125;
                        //ç§»åŠ¨åˆ°æ–°ä½ç½®çš„é“¾è¡¨ï¼Œæ•°ç»„ä¸‹æ ‡ä¸ºåŸä¸‹æ ‡åŠ æ—§æ•°ç»„é•¿åº¦
                        if (hiTail != null) &#123;
                            hiTail.next = null;
                            newTab[j + oldCap] = hiHead;
                        &#125;
                    &#125;
                &#125;
            &#125;
        &#125;
        return newTab;
    &#125;
&#125;
</code></pre>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-08-11</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Limit Lau</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Java/'>
                            Java
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E6%BA%90%E7%A0%81/'>
                            æºç 
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        

     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â© 2019-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>Rage, rage against the dying of the lightğŸ­</span>
            
    
</div>


    
        
<link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/css/a11y-dark.min.css">

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js"></script>

        
<script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js"></script>

    


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>